on:
    workflow_dispatch:
    pull_request:
    push:
      branches:    
        - main
  
name: Check docker-compose for updates

jobs:
    check_modified_compose_files:
        name: check docker-compose files
        runs-on: ubuntu-latest
        steps:
          - name: checkout
            uses: actions/checkout@v4
            with:
                fetch-depth: 0
          - name: check git diff  
            run: |
                  check_diff() {
                    echo $(git diff --name-only origin/main...HEAD | grep -E  'docker-compose[A-Za-z0-9.-]+.yml' | wc -l)    
                  }
                  
                  if [ "$(check_diff)" -eq 0 ]; then
                    exit 0
                  else
                    echo "Do not modify docker-compose files" && exit 1
                  fi    
